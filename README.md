# 驰达IT资产管理系统 (CDITAMS)

驰达IT资产管理系统（CDITAMS）是一款面向企业的IT资产全生命周期管理软件，帮助企业实现IT资产的规范化、信息化管理。

## 功能特性

### 资产管理
- 设备管理（增删改查、分配、报障、报废）
- 资产分类管理（支持1-4级分类）
- 位置管理（支持1-4级层级：园区→设施→楼层→区域）
- 设备地图可视化（楼层平面图绘制）
- 工位管理（工位绑定设备）
- 软件管理
- 耗材管理
- 服务管理

### 组织管理
- 用户管理
- 部门管理（树形结构）
- 角色权限管理

### 盘点管理
- 盘点计划
- 盘点任务
- 盘点执行
- 盘点报表

### 系统功能
- 设备地图可视化
  - 地图编辑器（画墙、门、窗、工位）
  - 门方向设置（左开/右开/推拉）
  - 自动门垛生成
  - 吸附对齐功能
  - 标尺坐标显示
  - 撤销/重做
- 工位管理
  - 手动创建
  - 批量生成
  - 设备绑定工位

## 技术栈

- **后端**: Django 5.0+
- **前端**: HTML5, CSS3, JavaScript
- **数据库**: SQLite（默认）/ MySQL/PostgreSQL
- **图表**: Canvas API

## 项目结构

```
CDITAMS/
├── apps/
│   └── assets/          # 资产管理应用
├── templates/           # HTML模板
├── static/             # 静态文件
├── media/              # 上传文件
├── cditams/            # Django项目配置
├── db.sqlite3          # 数据库文件
├── manage.py           # Django管理脚本
├── init_data.py        # 数据初始化脚本
└── requirements.txt    # Python依赖
```

## 快速开始

### 1. 环境要求

- Python 3.8+
- Django 5.0+

### 2. 安装依赖

```bash
cd CDITAMS
pip install -r requirements.txt
```

### 3. 数据库初始化

```bash
# 创建数据库表
python3 manage.py migrate

# 初始化默认数据（可选）
python3 init_data.py

# 创建超级管理员
python3 manage.py createsuperuser
```

### 4. 启动服务

```bash
# 开发模式启动
python3 manage.py runserver 0.0.0.0:8000
```

### 5. 访问系统

- 系统地址: http://127.0.0.1:8000/
- 管理后台: http://127.0.0.1:8000/admin/

### 6. 登录账号

默认超级管理员：
- **工号**: 86000001
- **密码**: password

## 设备地图使用流程

### 位置层级说明

| 级别 | 名称 | 示例 | 说明 |
|------|------|------|------|
| 1级 | 园区 | 产业园区、草滩园区 | 最高层级 |
| 2级 | 设施 | 办公楼A栋、生产车间 | 园区内的建筑物，设置楼层数后自动生成楼层 |
| 3级 | 楼层 | 1楼、2楼、3楼 | 绘制平面图的位置 |
| 4级 | 房间/区域 | A301室、B区 | 绑定到3级楼层的平面图内 |

### 步骤1：创建位置层级

1. 进入 **资产管理 → 位置管理**
2. 依次创建：
   - **1级 - 园区**（如：产业园区，编码：CY）
   - **2级 - 设施**（如：办公楼A栋，编码：CY-OA），设置**楼层数**（如：6）
   - 系统会自动生成6个3级楼层位置（如：1楼、2楼...6楼）
   - **4级 - 房间/区域**（如：A301室，编码：CY-OA-03-A301）

### 步骤2：启用平面图

1. 编辑3级位置（楼层），如"3楼"
2. 勾选"启用平面图"
3. 设置画布宽度/高度（如：1200×800）
4. 保存

### 步骤3：编辑平面图

1. 点击"编辑地图"按钮
2. 使用工具栏绘制：
   - **选择 (V)** - 选中/移动元素
   - **画墙 (W)** - 绘制墙体
   - **画门 (D)** - 绘制门（支持左开/右开/推拉）
   - **画窗 (N)** - 绘制窗户
   - **画工位 (B)** - 绘制工位
3. 快捷键：
   - **G** - 切换网格显示
   - **S** - 切换吸附功能
   - **Ctrl+Z** - 撤销
   - **Ctrl+Y** - 重做
   - **Delete** - 删除选中
4. 点击"保存"

### 步骤4：工位管理

1. 点击"工位管理"
2. 可选择：
   - 手动添加工位
   - 批量创建工位（设置行列数和间距）

### 步骤5：查看地图

1. 点击"查看地图"或从"设备地图"入口进入
2. 查看设备分布（工位和设备标记）
3. 点击工位查看详情，点击设备标记查看设备信息
4. 点击区域可跳转到对应房间

## 地图编辑器功能说明

| 功能 | 说明 | 快捷键 |
|------|------|--------|
| 选择工具 | 选中、移动元素 | V |
| 画墙 | 绘制直线墙体 | W |
| 画门 | 绘制门（支持方向设置） | D |
| 画窗 | 绘制窗户 | N |
| 画工位 | 绘制工位矩形 | B |
| 放大 | 放大视图 | + |
| 缩小 | 缩小视图 | - |
| 网格 | 显示/隐藏网格 | G |
| 吸附 | 开启/关闭吸附对齐 | S |
| 撤销 | 撤销上一步操作 | Ctrl+Z |
| 重做 | 重做操作 | Ctrl+Y |
| 删除 | 删除选中元素 | Delete |
| 上传底图 | 上传图片作为地图背景 | - |
| 清除底图 | 清除背景图片 | - |

## 配置说明

### 地图配置

在位置编辑页面可配置：

- **地图宽度/高度**: 画布大小
- **网格大小**: 网格间距（默认50px）
- **默认门垛宽度**: 自动生成门垛宽度（默认15px）
- **默认吸附阈值**: 吸附灵敏度（默认10px）
- **默认启用吸附**: 新元素默认吸附开关

### 门设置

选中门元素后可配置：

- **门开方向**: 右开/左开/推拉
- **门宽**: 门宽度（默认60px）
- **打开角度**: 门打开角度（45°-180°）
- **自动生成门垛**: 是否自动生成门垛
- **门垛宽度**: 门垛宽度

## 常见问题

### Q: 如何进入设备地图？
A: 
- 方式1：资产管理 → 位置管理 → 选择3级楼层 → 点击地图图标
- 方式2：资产管理 → 设备地图（侧边栏入口）

### Q: 为什么看不到平面图编辑按钮？
A: 只有3级位置（楼层）才能启用平面图功能。请先创建完整的位置层级（园区→设施→楼层）。

### Q: 2级设施创建时如何自动生成楼层？
A: 在创建2级设施时，设置"楼层数"字段（如：6），系统会自动创建6个3级楼层位置。

### Q: 如何绑定设备到工位？
A: 在工位管理页面，点击工位旁的"绑定设备"按钮，选择设备进行绑定。

## 开发相关

### 创建新的数据库迁移

```bash
python3 manage.py makemigrations
```

### 应用数据库迁移

```bash
python3 manage.py migrate
```

### 收集静态文件

```bash
python3 manage.py collectstatic
```

## 许可证

本项目仅供内部使用。
