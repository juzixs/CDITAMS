{% extends 'base.html' %}
{% block title %}盘点计划详情{% endblock %}
{% block content %}
<div class="d-flex justify-content-between align-items-center mb-4">
<h4>盘点计划详情</h4>
<div>{% if plan.status == 'draft' %}<a href="{% url 'plan_generate_tasks' plan.id %}" class="btn btn-success">生成任务</a>{% endif %}
<a href="{% url 'plan_list' %}" class="btn btn-outline-secondary">返回</a></div>
</div>
<div class="card mb-3"><div class="card-body">
<p><strong>计划名称：</strong>{{ plan.name }}</p>
<p><strong>计划编号：</strong>{{ plan.plan_no }}</p>
<p><strong>类型：</strong>{{ plan.get_plan_type_display }}</p>
<p><strong>状态：</strong>{{ plan.get_status_display }}</p>
<p><strong>时间：</strong>{{ plan.scheduled_start|date:"Y-m-d" }} ~ {{ plan.scheduled_end|date:"Y-m-d" }}</p>
</div></div>
<div class="card"><div class="card-header">盘点任务</div><div class="card-body">
<table class="table"><thead><tr><th>任务编号</th><th>位置</th><th>应盘数量</th><th>已盘数量</th><th>状态</th><th>操作</th></tr></thead>
<tbody>{% for t in tasks %}<tr><td>{{ t.task_no }}</td><td>{{ t.location.name|default:'-' }}</td><td>{{ t.device_count }}</td><td>{{ t.checked_count }}</td><td>{{ t.get_status_display }}</td>
<td><a href="{% url 'task_detail' t.id %}" class="btn btn-sm btn-outline-primary">详情</a></td></tr>{% empty %}<tr><td colspan="6" class="text-center">暂无任务</td></tr>{% endfor %}</tbody></table>
</div></div>{% endblock %}
