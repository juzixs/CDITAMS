{% extends 'base.html' %}
{% block title %}设备地图 - 驰达IT资产管理系统{% endblock %}
{% block extra_css %}
<style>
.location-card { cursor: pointer; transition: all 0.2s; }
.location-card:hover { transform: translateY(-3px); box-shadow: 0 4px 12px rgba(0,0,0,0.15); }
.location-card .card-body { padding: 1rem; }
.location-icon { font-size: 2rem; }
.stat-badge { font-size: 11px; }
</style>
{% endblock %}
{% block content %}
<div class="d-flex justify-content-between align-items-center mb-4">
<h4><i class="fas fa-map-marked-alt"></i> 设备地图</h4>
<div>
    <a href="{% url 'device_list' %}" class="btn btn-outline-secondary me-2"><i class="fas fa-arrow-left"></i> 返回</a>
    <a href="{% url 'location_list' %}" class="btn btn-outline-secondary"><i class="fas fa-sitemap"></i> 位置管理</a>
</div>
</div>

{% if locations %}
<div class="row">
{% for loc in locations %}
<div class="col-md-4 col-sm-6 mb-3">
<div class="card location-card h-100" onclick="window.location.href='{% url 'location_map' loc.id %}'">
<div class="card-body">
<div class="d-flex align-items-center mb-2">
<i class="fas fa-layer-group location-icon text-info me-3"></i>
<div>
<h6 class="mb-0">{{ loc.name }}</h6>
<small class="text-muted">{{ loc.full_path }}</small>
</div>
</div>
<div class="d-flex gap-2">
<span class="badge bg-primary stat-badge"><i class="fas fa-th"></i> {{ loc.workstation_count }} 工位</span>
<span class="badge bg-info stat-badge"><i class="fas fa-desktop"></i> {{ loc.device_count }} 设备</span>
</div>
</div>
<div class="card-footer bg-transparent d-flex justify-content-between">
<small class="text-muted">点击查看平面图</small>
<i class="fas fa-arrow-right text-muted"></i>
</div>
</div>
</div>
{% endfor %}
</div>
{% else %}
<div class="card">
<div class="card-body text-center py-5">
<i class="fas fa-map-marked-alt text-muted" style="font-size: 4rem;"></i>
<h5 class="mt-3">暂无启用的平面图</h5>
<p class="text-muted mb-3">请先在位置管理中创建楼层（3级位置）并启用平面图</p>
<a href="{% url 'location_list' %}" class="btn btn-primary"><i class="fas fa-sitemap"></i> 前往位置管理</a>
</div>
</div>
{% endif %}

<div class="card mt-4">
<div class="card-header"><i class="fas fa-info-circle"></i> 操作说明</div>
<div class="card-body">
<p class="mb-2"><strong>层级结构：</strong></p>
<ul class="text-muted">
<li><span class="badge bg-warning text-dark">1级</span> <strong>园区</strong> → 如：产业园区</li>
<li><span class="badge bg-primary">2级</span> <strong>设施</strong> → 如：办公楼A栋（设置楼层数自动生成楼层）</li>
<li><span class="badge bg-info">3级</span> <strong>楼层</strong> → 如：3楼（绘制平面图）</li>
<li><span class="badge bg-success">4级</span> <strong>房间/区域</strong> → 如：A301室</li>
</ul>
<p class="mb-2"><strong>快速入口：</strong></p>
<ol class="text-muted">
<li>在 <strong>位置管理</strong> 中创建位置层级</li>
<li>编辑3级位置（楼层），启用平面图并设置画布大小</li>
<li>点击 <strong>编辑平面图</strong> 绘制楼层平面图</li>
<li>点击 <strong>工位管理</strong> 创建工位</li>
<li>返回此处，点击卡片查看设备分布</li>
</ol>
</div>
</div>
{% endblock %}
